<!DOCTYPE htm1 >
<html >
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>航院跳蚤市场</title>
		<link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon"/>
	    <script type="text/javascript">  
	            function browserRedirect() {  
	                var sUserAgent = navigator.userAgent.toLowerCase();  
	                var bIsIpad = sUserAgent.match(/ipad/i) == "ipad";  
	                var bIsIphoneOs = sUserAgent.match(/iphone os/i) == "iphone os";  
	                var bIsMidp = sUserAgent.match(/midp/i) == "midp";  
	                var bIsUc7 = sUserAgent.match(/rv:1.2.3.4/i) == "rv:1.2.3.4";  
	                var bIsUc = sUserAgent.match(/ucweb/i) == "ucweb";  
	                var bIsAndroid = sUserAgent.match(/android/i) == "android";  
	                var bIsCE = sUserAgent.match(/windows ce/i) == "windows ce";  
	                var bIsWM = sUserAgent.match(/windows mobile/i) == "windows mobile";  
	                if (bIsIpad || bIsIphoneOs || bIsMidp || bIsUc7 || bIsUc || bIsAndroid || bIsCE || bIsWM) {  
	                    window.location = "mobile.html";  
	                };
	            };  
	      
	            browserRedirect();  
	    </script>  
		<link rel="stylesheet" type="text/css" href="css/index.css" />
		<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"/>
		<script type="text/javascript" src="js/jquery.min.js"></script>
		<script type="text/javascript" src="js/angular.min.js"></script>
		<script type="text/javascript" src="js/jquery.imgpreload.min.js"></script>
	</head> 
	<body  ng-app="ui" ng-controller="uii">
	<div id="main">
			<div class="lodging1">	
				<div class="jindutiao">
					
				</div>
				<div class="spinner"> <!--加载动画-->
				  <div class="spinner-container container1">
				    <div class="circle1"></div>
				    <div class="circle2"></div>
				    <div class="circle3"></div>
				    <div class="circle4"></div>
				  </div>
				  <div class="spinner-container container2">
				    <div class="circle1"></div>
				    <div class="circle2"></div>
				    <div class="circle3"></div>
				    <div class="circle4"></div>
				  </div>
				  <div class="spinner-container container3">
				    <div class="circle1"></div>
				    <div class="circle2"></div>
				    <div class="circle3"></div>
				    <div class="circle4"></div>
				  </div>
				  <div id="percentShow">
				  </div>
				</div>			
			</div>	
			
			<div class="main0" >
				<div id="wrapper"><!-- 最外层部分 -->
			    	<div id="banner"><!-- 轮播部分 -->
			      		<ul class="imgList"><!-- 图片部分 -->
			        		  <li id="img0"><img  src="img/bg1.jpg" width="1920px" height="1080px" alt="图片无法加载=_=" ></li>
						      <li id="img1"><img  src="img/bg2.jpg" width="1920px" height="1080px" alt="图片无法加载=_=" ></li>
						      <li id="img2"><img  src="img/bg3.jpg" width="1920px" height="1080px" alt="图片无法加载=_=" ></li>
						      <li id="img3"><img  src="img/bg4.jpg" width="1920px" height="1080px" alt="图片无法加载=_=" ></li>
						      <li id="img4"><img  src="img/bg5.jpg" width="1920px" height="1080px" alt="图片无法加载=_=" ></li>
						</ul>
						//图片滚轮
					    <!--<img src="./img/prev.png" width="20px" height="40px" id="prev">
					    	<img src="./img/next.png" width="20px" height="40px" id="next">-->
					    <div   id="prev">》</div>
					    <div   id="next">》</div>	
					    <div class="bg">
					    <!--<div class="header-top">
							<div class="container">
								<ul>
									<li><a href="">登录</a></li>
									<li><a href="">注册</a></li>
								</ul>
							</div>
						</div>-->
						<div class="header-body">
							<div class="container"> 
								<div class="header-body-logo"></div>
								<div class="header-body-nav">
									<ul>
										<li class="nav_red" style="background-color:background-color: rgba(180,26,28,1) ;"><a href="">首页</a></li>
										<li><a href="dianmian.html">店铺中心</a></li>
										<li><a >交易规则</a></li>
										<!--<li><a href=" " style="font-size: 15px; line-height: 86px;" >登录</a></li>
										<li><a href=""  style="font-size: 15px; line-height: 86px;" >注册</a></li>-->
									</ul>
								</div>
							</div>
						</div>
					    </div> <!-- 图片底部背景层部分-->
					    <ul class="infoList"><!-- 图片左下角文字信息部分 -->
					        <li class="infoOn">
								<!--<div class="biaoti"></div>-->
								<div class="paifang1" ng-click="paifang1()"></div>
								<a href="dianmian.html"><div class="paifang2"></div></a>
					        </li>
					        <li>
		
					        	
					        </li>
					        <li>
					        	<form class="sousuo">
					        		<input type="text" name="" id="sousuo" value="" placeholder="快速搜索商品" />
					        		<button type="submit" class="tubiao">搜索</button>
					        	</form>			        	
					        </li>
					        <li></li>
					        <li>
					        	<div class="wenzi">
									<!--<pre id="wenzi_xianshi"></pre>-->
									<b id="wenzi_xianshi"></b>
					        	</div>
									<div style="display:none" id="wenzi_bianji">
									此为小小的作品，用作个人毕业设计，还没有完成，许多功能页面等正在努力制作中，交易规则等等正在构思中，用户数据暂时用本地存储来模拟后台，设计得不是很好，代码比较乱还没有整理，有什么想说的、想建议的可以联系我。<br />
									QQ:929699972 <br />
									email:929699972@qq.com <br />
									==================梁文聪=====================
									</div>			        	
					        </li>
					    </ul>
					    <ul class="indexList"><!-- 图片右下角序号部分 -->
					        <li class="indexOn"></li>
					        <li></li>
					        <li></li>
					        <li></li>
					        <li></li>
					    </ul>
					</div>
			  	
					<div id="baiban">
						<div id="top"></div>
						<div id="bottom"></div>
					</div>	
	
				</div>			
			</div>		
			
	</div>

		




		


		<script type="text/javascript">
			//预加载。。
			var imgNum = 0;
			var images = [];
			$(function(){ preLoadImg(); });
			 
			function preLoadImg() {
				//get all imgs those tag is <img>
//			    var imgs = document.images;
//			    for (var i = 0; i < imgs.length; i++) {
//			        images.push(imgs[i].src);
//			    }
//			    //get all images in style
//			    var cssImages = getallBgimages();
//			    for (var j = 0; j < cssImages.length; j++) {
//			        images.push(cssImages[j]);
//			    }
//			    $.imgpreload(['img/bg1.jpg', 'img/bg2.jpg','img/bg3.jpg','img/bg4.jpg','img/bg5.jpg'], function () {
//			          //此处是显示进度百分比时需要用到的背景图，这个可以先加载进去
//			          
//			    });
//			 
//			    //then push all other images in array to load    
			    images.push("img/bg1.jpg");
			    images.push("img/bg2.jpg");
			    images.push("img/bg3.jpg");
			    images.push("img/bg4.jpg");
			    images.push("img/bg5.jpg");
			    /*这里是图片预加载 preload*/
			    $.imgpreload(images,
			    {
			        each: function () {
			            /*this will be called after each image loaded*/
			            var status = $(this).data('loaded') ? 'success' : 'error';
			            if (status == "success") {                
			                var v = (parseFloat(++imgNum) / images.length).toFixed(2);
			                $("#percentShow").html("<b>"+Math.round(v * 100) + "%<b>"); 
			                $(".jindutiao").css({"width": v*100+"%"})
			            }
			        },
			        all: function () {
			            /*this will be called after all images loaded*/
			            $("#percentShow ").html("<b>100%<b>");
			 			$(".jindutiao").css({"width":100+"%"})
			 			$(".spinner").fadeOut();
			            $(".lodging1").fadeOut(2000);            
			            $(".main0").fadeIn(1000); 
			            $("#baiban #top").css({"width":0});
			            $("#baiban #bottom").css({"width":0});
			            $("#baiban").fadeOut(1500);

			        }
			    });
			 };
			 //白板动画重新启动
//			 function baiban(){
//			            $("#baiban #top").css({"width":100+"%"});
//			            $("#baiban #bottom").css({"width":100+"%"});
//			            
//			   			 $("#baiban").show();
//			            $("#baiban #top").css({"width":0});
//			            $("#baiban #bottom").css({"width":0});
//			            $("#baiban").fadeOut(1500);
//			            
//			            
//			 }

		  
			$(".imgList").find("li").eq(0).show();
		  //轮播图
		  var curIndex = 0, //当前index
		      imgLen = $(".imgList li").length; //图片总数
		     // 定时器自动变换2.5秒每次
		  var autoChange = setInterval(function(){ 
		  	xiaoshi(curIndex);
		    if(curIndex < imgLen-1){ 
		      curIndex ++; 
		    }else{ 
		      curIndex = 0;
		    }
		    //调用变换处理函数
		    changeTo(curIndex); 
		    //调用开始文字函数
//		    if(curIndex == 0){
//		    	baiban();
//		    };
		    if(curIndex == 4){
		    	startwenzi();
		    }else{
		    	clearwenzi();
		    }
		  },30000);
		   //左箭头滑入滑出事件处理
		  $("#prev").hover(function(){ 
		    //滑入清除定时器
		    clearInterval(autoChange);
		  },function(){ 
		    //滑出则重置定时器
		    autoChangeAgain();
		  });
		  //左箭头点击处理
		  $("#prev").click(function(){ 
		    //根据curIndex进行上一个图片处理
		    xiaoshi(curIndex);
		    curIndex = (curIndex > 0) ? (--curIndex) : (imgLen - 1);
		    changeTo(curIndex);
//		    if(curIndex == 0){
//		    	baiban();
//		    };
		    if(curIndex == 4){
		    	startwenzi();
		    }else{
		    	clearwenzi();
		    };
		  });
		  //右箭头滑入滑出事件处理
		  $("#next").hover(function(){ 
		    //滑入清除定时器
		    clearInterval(autoChange);
		  },function(){ 
		    //滑出则重置定时器
		    autoChangeAgain();
		  });
		  //右箭头点击处理
		  $("#next").click(function(){ 
		  	xiaoshi(curIndex);
		    curIndex = (curIndex < imgLen - 1) ? (++curIndex) : 0;
		    changeTo(curIndex);
//		    if(curIndex == 0){
//		    	baiban();
//		    };
		    if(curIndex == 4){
		    	startwenzi();
		    }else{
		    	clearwenzi();
		    };
		  });
		  //对下方按钮index进行事件绑定处理等
		  $(".indexList").find("li").each(function(item){ 
		    $(this).hover(function(){ 
		    	
		      clearInterval(autoChange);
		      if (item != curIndex){
		      	xiaoshi(curIndex);
		      	changeTo(item);
//			    if(item == 0){
//			    	baiban();
//			    };
		      	if(item == 4){
		      		startwenzi();
		      	}else{
		      		clearwenzi();
		      	}
		      	curIndex = item;
		      }
	
		    },function(){ 
		      autoChangeAgain();
		    });
		  });
		  //清除定时器时候的重置定时器--封装
		  function autoChangeAgain(){ 
		      autoChange = setInterval(function(){ 
		      	xiaoshi(curIndex);
		      if(curIndex < imgLen-1){ 
		        curIndex ++;
		      }else{ 
		        curIndex = 0;
		      }
		    //调用变换处理函数
		      changeTo(curIndex); 
		      if(curIndex == 4){
		      	startwenzi();
		      }else{
		      	clearwenzi();
		      }
		      
		    },30000);
		    }
		  //input聚焦时
		  $("#sousuo").focus(function(){
		  	clearInterval(autoChange);
		  });
		  //input失焦时
		  $("#sousuo").blur(function(){
		  	autoChangeAgain();
		  });
	
			function xiaoshi(num){
				$(".imgList").find("li").eq(num).find("img").css({"width":0,"height":0,})
				$(".imgList").find("li").eq(num).hide(2000);
			}
		  function changeTo(num){ 
			$(".imgList").find("li").eq(num).find("img").css({"width": $(window).width(),"height": $(window).height(),})	
		  	$(".imgList").find("li").eq(num).fadeIn(2000);
	//	    $(".imgList").animate({left: "-" + goLeft + "px"},50);
		    $(".infoList").find("li").removeClass("infoOn").eq(num).addClass("infoOn");
		    $(".indexList").find("li").removeClass("indexOn").eq(num).addClass("indexOn");
		  }
		  
		  //交易规则文字部分
		  var wenzi_time = "";
		  	function startwenzi(){
		  		$(".header-body-nav").find("li").removeClass("nav_red").eq(2).addClass("nav_red");
		  		var wenzi_index=0;
				var word=document.getElementById("wenzi_bianji").innerHTML;
				function type(){
				    document.getElementById("wenzi_xianshi").innerHTML = word.substring(0,wenzi_index++);
				}
				wenzi_time = setInterval(type, 70);	 
		  	};
		  	function clearwenzi(){
		  		$(".header-body-nav").find("li").removeClass("nav_red").eq(0).addClass("nav_red");
		  		clearInterval(wenzi_time);
				$("#wenzi_xianshi").empty();
		  	};
	
			//导航处理

			$(".header-body-nav").find("li").eq(2).click(function(){
				if(curIndex != 4){
					xiaoshi(curIndex)
					curIndex = 4;
					changeTo(curIndex);
					startwenzi();
				}
			});
			
		  
		  //响应窗口大小部分
		  $(function(){ 
				$(document).ready(function(){ 
	
					var w = $(window).width();//容器宽度 
				   	var h = $(window).height();
				   	$(".imgList img").each(function(){
				   		$(this).css({"width":w,"height":h});//设置缩放后的宽度和高度
				   		});
				   	$(".infoList .wenzi").css({"width":w*0.58,"left": "-" + w*0.28,});//交易规则文字
			}); 
	
						$(window).resize(function(){
							   //process her
							   var w = $(window).width() ;//容器宽度 
							   var h = $(window).height() ;
							$(".imgList img").each(function(){//如果有很多图片，我们可以使用each()遍历 
								$(this).css({"width":w,"height":h,});//设置缩放后的宽度和高度
							});
							$(".infoList .wenzi").css({"width":w*0.58,"left": "-" + w*0.28,});//交易规则文字
							   
						});
								
					
					}); 
		  
		  
		  </script>
		  
		  <script type="text/javascript">
		  	var app = angular.module("ui",[]);
		  	app.controller("uii",["$scope","$window",function($scope,$window){
				//存储对象，以JSON格式存储
				var setObject = function(key,value){
					$window.localStorage[key]=JSON.stringify(value);
				}; 
				//读取对象
				var getObject = function(key){
					return JSON.parse($window.localStorage[key] || '{}');
				};
				//检查是否为数组的函数
				function isArray(o){
				return Object.prototype.toString.call(o)=='[object Array]';
				};
				//用户信息
				if (isArray(getObject("presentUser"))){
					$scope.presentUser = getObject("presentUser");
				}else{
					$scope.presentUser = [];
				}; 

				//判断用户是否登录
				$scope.paifang1 = function(){
					if($scope.presentUser[0]){
						window.location.href="user.html";
					}else{
						window.location.href="login.html";
					};					
				};

		  	}]);
		  </script>
	</body>
</html>
